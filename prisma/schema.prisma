generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "postgresql"
}

model User {
  id               String           @id
  name             String
  email            String           @unique
  emailVerified    Boolean          @default(false)
  image            String?
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
  banExpires       DateTime?
  banReason        String?
  banned           Boolean?         @default(false)
  displayUsername  String?
  lastLoginMethod  String?
  role             String?
  stripeCustomerId String?
  twoFactorEnabled Boolean?         @default(false)
  username         String?          @unique
  accounts         Account[]
  business_users   business_users[]
  businesses       businesses[]
  sessions         Session[]
  twofactors       TwoFactor[]

  @@map("user")
}

model Session {
  id             String   @id
  expiresAt      DateTime
  token          String   @unique
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  ipAddress      String?
  userAgent      String?
  userId         String
  impersonatedBy String?
  user           User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@map("session")
}

model Account {
  id                    String    @id
  accountId             String
  providerId            String
  userId                String
  accessToken           String?
  refreshToken          String?
  idToken               String?
  accessTokenExpiresAt  DateTime?
  refreshTokenExpiresAt DateTime?
  scope                 String?
  password              String?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@map("account")
}

model Verification {
  id         String   @id
  identifier String
  value      String
  expiresAt  DateTime
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@index([identifier])
  @@map("verification")
}

model TwoFactor {
  id          String @id
  secret      String
  backupCodes String
  userId      String
  user        User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([secret])
  @@index([userId])
  @@map("twoFactor")
}

model boms {
  id                String              @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id       String              @db.Uuid
  name              String
  product_id        String              @db.Uuid
  output_quantity   Decimal?            @default(1) @db.Decimal(12, 2)
  notes             String?
  created_at        DateTime?           @default(now()) @db.Timestamptz(6)
  updated_at        DateTime?           @default(now()) @db.Timestamptz(6)
  domain_data       Json?               @default("{}")
  version           String?             @default("1.0") @db.VarChar(20)
  bom_materials     bom_materials[]
  businesses        businesses          @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products          products            @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  production_orders production_orders[]

  @@index([domain_data], map: "idx_boms_domain_data", type: Gin)
}

model bom_materials {
  id          String     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id String     @db.Uuid
  bom_id      String     @db.Uuid
  material_id String     @db.Uuid
  quantity    Decimal    @db.Decimal(12, 2)
  unit        String?
  boms        boms       @relation(fields: [bom_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  businesses  businesses @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products    products   @relation(fields: [material_id], references: [id], onUpdate: NoAction)

  @@index([bom_id], map: "idx_bom_materials_bom")
}

model business_users {
  id          String     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id String     @db.Uuid
  user_id     String
  role        String     @default("salesperson")
  status      String?    @default("active")
  permissions Json?      @default("{}")
  created_at  DateTime?  @default(now()) @db.Timestamptz(6)
  updated_at  DateTime?  @default(now()) @db.Timestamptz(6)
  businesses  businesses @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  user        User       @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([business_id, user_id], map: "unique_user_per_business")
}

model businesses {
  id                      String                    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id                 String?
  business_name           String
  email                   String
  phone                   String?
  ntn                     String?
  cnic                    String?
  srn                     String?
  address                 String?
  city                    String?
  state                   String?
  country                 String?                   @default("Pakistan")
  postal_code             String?
  domain                  String
  category                String
  logo_url                String?
  created_at              DateTime?                 @default(now()) @db.Timestamptz(6)
  updated_at              DateTime?                 @default(now()) @db.Timestamptz(6)
  currency                String?                   @default("PKR")
  timezone                String?                   @default("Asia/Karachi")
  settings                Json?                     @default("{}")
  bom_materials           bom_materials[]
  boms                    boms[]
  business_users          business_users[]
  user                    User?                     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  customers               customers[]
  delivery_challan_items  delivery_challan_items[]
  delivery_challans       delivery_challans[]
  gl_accounts             gl_accounts[]
  gl_entries              gl_entries[]
  inventory_ledger        inventory_ledger[]
  invoice_items           invoice_items[]
  invoices                invoices[]
  payments                payments[]
  product_batches         product_batches[]
  product_serials         product_serials[]
  product_stock_locations product_stock_locations[]
  product_variants        product_variants[]
  production_orders       production_orders[]
  products                products[]
  purchases               purchases[]
  quotation_items         quotation_items[]
  quotations              quotations[]
  sales_order_items       sales_order_items[]
  sales_orders            sales_orders[]
  stock_movements         stock_movements[]
  stock_transfers         stock_transfers[]
  tax_configurations      tax_configurations[]
  vendors                 vendors[]
  warehouse_locations     warehouse_locations[]
  workflow_rules          workflow_rules[]
  workflow_history        workflow_history[]
  audit_logs              audit_logs[]
  promotions              promotions[]
  campaigns               campaigns[]
  customer_segments       customer_segments[]
  inventory_reservations  inventory_reservations[]
  supplier_quotes         supplier_quotes[]
  price_lists             price_lists[]
}

model customers {
  id                  String              @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id         String              @db.Uuid
  name                String
  email               String?
  phone               String?
  ntn                 String?
  cnic                String?
  srn                 String?
  address             String?
  city                String?
  state               String?
  pincode             String?
  country             String?             @default("Pakistan")
  credit_limit        Decimal?            @default(0) @db.Decimal(12, 2)
  outstanding_balance Decimal?            @default(0) @db.Decimal(12, 2)
  created_at          DateTime?           @default(now()) @db.Timestamptz(6)
  updated_at          DateTime?           @default(now()) @db.Timestamptz(6)
  domain_data         Json?               @default("{}")
  opening_balance     Decimal?            @default(0) @db.Decimal(12, 2)
  filer_status        String?             @default("none") @db.VarChar(50)
  is_deleted          Boolean             @default(false)
  deleted_at          DateTime?           @db.Timestamptz(6)
  businesses          businesses          @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  delivery_challans   delivery_challans[]
  invoices            invoices[]
  payments            payments[]
  product_serials     product_serials[]
  quotations          quotations[]
  sales_orders        sales_orders[]

  @@index([domain_data], map: "idx_customers_domain_data", type: Gin)
  @@index([business_id, email])
  @@index([business_id, phone])
  @@index([is_deleted])
}

model gl_accounts {
  id                String        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id       String        @db.Uuid
  code              String
  name              String
  type              String
  description       String?
  parent_id         String?       @db.Uuid
  is_active         Boolean?      @default(true)
  created_at        DateTime?     @default(now()) @db.Timestamptz(6)
  businesses        businesses    @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  gl_accounts       gl_accounts?  @relation("gl_accountsTogl_accounts", fields: [parent_id], references: [id], onUpdate: NoAction)
  other_gl_accounts gl_accounts[] @relation("gl_accountsTogl_accounts")
  gl_entries        gl_entries[]

  @@unique([business_id, code])
}

model gl_entries {
  id               String      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id      String      @db.Uuid
  transaction_date DateTime    @db.Date
  description      String?
  account_id       String      @db.Uuid
  debit            Decimal?    @default(0) @db.Decimal(12, 2)
  credit           Decimal?    @default(0) @db.Decimal(12, 2)
  reference_type   String?
  reference_id     String?     @db.Uuid
  created_at       DateTime?   @default(now()) @db.Timestamptz(6)
  gl_accounts      gl_accounts @relation(fields: [account_id], references: [id], onUpdate: NoAction)
  businesses       businesses  @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model invoices {
  id             String          @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id    String?         @db.Uuid
  invoice_number String
  customer_id    String?         @db.Uuid
  date           DateTime        @db.Date
  due_date       DateTime?       @db.Date
  subtotal       Decimal?        @default(0.00) @db.Decimal(12, 2)
  total_tax      Decimal?        @default(0.00) @db.Decimal(12, 2)
  total_amount   Decimal?        @default(0.00) @db.Decimal(12, 2)
  status         String?         @default("draft")
  notes          String?
  created_at     DateTime?       @default(now()) @db.Timestamptz(6)
  updated_at     DateTime?       @default(now()) @db.Timestamptz(6)
  tax_total      Decimal?        @default(0) @db.Decimal(12, 2)
  discount_total Decimal?        @default(0) @db.Decimal(12, 2)
  grand_total    Decimal?        @default(0) @db.Decimal(12, 2)
  payment_method String?
  payment_status String?
  terms          String?
  tax_details    Json?           @default("{}")
  is_deleted     Boolean         @default(false)
  deleted_at     DateTime?       @db.Timestamptz(6)
  invoice_items  invoice_items[]
  businesses     businesses?     @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  customers      customers?      @relation(fields: [customer_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([business_id, invoice_number])
  @@index([business_id, date])
  @@index([business_id, status])
  @@index([is_deleted])
}

model product_serials {
  id                     String               @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id            String?              @db.Uuid
  product_id             String?              @db.Uuid
  variant_id             String?              @db.Uuid
  serial_number          String               @unique
  imei                   String?              @unique
  mac_address            String?              @unique
  status                 String?              @default("in_stock")
  purchase_date          DateTime?            @db.Date
  sale_date              DateTime?            @db.Date
  warranty_expiry_date   DateTime?            @db.Date
  warranty_period_months Int?
  notes                  String?
  created_at             DateTime?            @default(now()) @db.Timestamptz(6)
  updated_at             DateTime?            @default(now()) @db.Timestamptz(6)
  batch_id               String?              @db.Uuid
  warehouse_id           String?              @db.Uuid
  warranty_start_date    DateTime?            @db.Date
  warranty_end_date      DateTime?            @db.Date
  invoice_id             String?              @db.Uuid
  customer_id            String?              @db.Uuid
  product_batches        product_batches?     @relation(fields: [batch_id], references: [id], onUpdate: NoAction)
  businesses             businesses?          @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  customers              customers?           @relation(fields: [customer_id], references: [id], onUpdate: NoAction)
  products               products?            @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  product_variants       product_variants?    @relation(fields: [variant_id], references: [id], onUpdate: NoAction)
  warehouse_locations    warehouse_locations? @relation(fields: [warehouse_id], references: [id], onUpdate: NoAction)

  @@index([product_id], map: "idx_product_serials_product_id")
  @@index([status], map: "idx_product_serials_status")
}

model product_variants {
  id                String            @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id       String?           @db.Uuid
  product_id        String?           @db.Uuid
  variant_sku       String?           @unique
  variant_name      String?
  size              String?
  color             String?
  pattern           String?
  material          String?
  custom_attributes Json?             @default("{}")
  price             Decimal?          @default(0.00) @db.Decimal(12, 2)
  cost_price        Decimal?          @default(0.00) @db.Decimal(12, 2)
  mrp               Decimal?          @default(0.00) @db.Decimal(12, 2)
  stock             Decimal?          @default(0) @db.Decimal(12, 2)
  min_stock         Int?              @default(0)
  image_url         String?
  is_active         Boolean?          @default(true)
  created_at        DateTime?         @default(now()) @db.Timestamptz(6)
  updated_at        DateTime?         @default(now()) @db.Timestamptz(6)
  product_serials   product_serials[]
  businesses        businesses?       @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products          products?         @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([product_id], map: "idx_product_variants_product_id")
}

model production_orders {
  id                  String               @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id         String               @db.Uuid
  bom_id              String?              @db.Uuid
  quantity            Decimal              @db.Decimal(12, 2)
  status              String?              @default("planned")
  start_date          DateTime?            @db.Date
  due_date            DateTime?            @db.Date
  created_at          DateTime?            @default(now()) @db.Timestamptz(6)
  updated_at          DateTime?            @default(now()) @db.Timestamptz(6)
  product_id          String?              @db.Uuid
  warehouse_id        String?              @db.Uuid
  quantity_to_produce Decimal?             @db.Decimal(12, 2)
  notes               String?
  scheduled_date      DateTime?            @db.Date
  domain_data         Json?                @default("{}")
  batch_number        String?
  boms                boms?                @relation(fields: [bom_id], references: [id], onUpdate: NoAction)
  businesses          businesses           @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products            products?            @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  warehouse_locations warehouse_locations? @relation(fields: [warehouse_id], references: [id], onUpdate: NoAction)

  @@index([domain_data], map: "idx_production_orders_domain_data", type: Gin)
  @@index([product_id], map: "idx_production_orders_product")
  @@index([status], map: "idx_production_orders_status")
}

model products {
  id                      String                    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id             String                    @db.Uuid
  sku                     String?
  barcode                 String?
  description             String?
  category                String?
  brand                   String?
  price                   Decimal                   @default(0) @db.Decimal(12, 2)
  cost_price              Decimal?                  @db.Decimal(12, 2)
  mrp                     Decimal?                  @db.Decimal(12, 2)
  stock                   Decimal?                  @default(0) @db.Decimal
  min_stock               Decimal?                  @default(0) @db.Decimal(12, 2)
  min_stock_level         Decimal?                  @default(5) @db.Decimal(12, 2)
  max_stock               Decimal?                  @db.Decimal(12, 2)
  reorder_point           Decimal?                  @db.Decimal(12, 2)
  reorder_quantity        Decimal?                  @db.Decimal(12, 2)
  unit                    String?                   @default("pcs")
  hsn_code                String?
  sac_code                String?
  tax_percent             Decimal?                  @default(17) @db.Decimal(5, 2)
  image_url               String?
  is_active               Boolean?                  @default(true)
  domain_data             Json?                     @default("{}")
  batches                 Json?                     @default("[]")
  serial_numbers          Json?                     @default("[]")
  variants                Json?                     @default("[]")
  expiry_date             DateTime?                 @db.Date
  manufacturing_date      DateTime?                 @db.Date
  created_at              DateTime?                 @default(now()) @db.Timestamptz(6)
  updated_at              DateTime?                 @default(now()) @db.Timestamptz(6)
  batch_number            String?
  location                String?
  name                    String?
  unit_conversions        Json?                     @default("{}")
  is_deleted              Boolean                   @default(false)
  deleted_at              DateTime?                 @db.Timestamptz(6)
  bom_materials           bom_materials[]
  boms                    boms[]
  challan_items           challan_items[]
  delivery_challan_items  delivery_challan_items[]
  inventory_ledger        inventory_ledger[]
  invoice_items           invoice_items[]
  product_batches         product_batches[]
  product_serials         product_serials[]
  product_stock_locations product_stock_locations[]
  product_variants        product_variants[]
  production_orders       production_orders[]
  businesses              businesses                @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  purchase_items          purchase_items[]
  quotation_items         quotation_items[]
  sales_order_items       sales_order_items[]
  stock_movements         stock_movements[]
  stock_transfers         stock_transfers[]
  inventory_reservations  inventory_reservations[]
  promotion_products      promotion_products[]
  price_list_items        price_list_items[]

  @@index([business_id, sku])
  @@index([business_id, category])
  @@index([business_id, brand])
  @@index([is_deleted])
}

model purchases {
  id              String           @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id     String?          @db.Uuid
  purchase_number String
  vendor_id       String?          @db.Uuid
  date            DateTime         @db.Date
  total_amount    Decimal?         @default(0.00) @db.Decimal(12, 2)
  status          String?          @default("pending")
  created_at      DateTime?        @default(now()) @db.Timestamptz(6)
  updated_at      DateTime?        @default(now()) @db.Timestamptz(6)
  warehouse_id    String?          @db.Uuid
  subtotal        Decimal?         @default(0) @db.Decimal(12, 2)
  tax_total       Decimal?         @default(0) @db.Decimal(12, 2)
  notes           String?
  domain_data     Json?            @default("{}")
  purchase_items  purchase_items[]
  businesses      businesses?      @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  vendors         vendors?         @relation(fields: [vendor_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([business_id, purchase_number])
  @@index([domain_data], map: "idx_purchases_domain_data", type: Gin)
}

model stock_movements {
  id                  String               @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id         String               @db.Uuid
  product_id          String               @db.Uuid
  warehouse_id        String?              @db.Uuid
  transaction_type    String
  reference_id        String?              @db.Uuid
  reference_type      String?
  quantity_change     Decimal              @db.Decimal(12, 2)
  unit_cost           Decimal?             @db.Decimal(12, 2)
  notes               String?
  created_at          DateTime?            @default(now()) @db.Timestamptz(6)
  batch_id            String?              @db.Uuid
  movement_type       String?
  domain_data         Json?                @default("{}")
  product_batches     product_batches?     @relation(fields: [batch_id], references: [id], onUpdate: NoAction)
  businesses          businesses           @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products            products             @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  warehouse_locations warehouse_locations? @relation(fields: [warehouse_id], references: [id], onUpdate: NoAction, map: "stock_movements_warehouse_location_fkey")

  @@index([domain_data], map: "idx_stock_movements_domain_data_gin", type: Gin)
}

model tax_configurations {
  id                      String      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id             String?     @db.Uuid
  domain                  String
  default_sales_tax_rate  Decimal?    @default(17.00) @db.Decimal(5, 2)
  withholding_tax_percent Decimal?    @default(0.00) @db.Decimal(5, 2)
  fbr_integration_enabled Boolean?    @default(false)
  ntn_required            Boolean?    @default(true)
  strn_required           Boolean?    @default(false)
  created_at              DateTime?   @default(now()) @db.Timestamptz(6)
  updated_at              DateTime?   @default(now()) @db.Timestamptz(6)
  businesses              businesses? @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model vendors {
  id                  String      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id         String      @db.Uuid
  name                String
  email               String?
  phone               String?
  ntn                 String?
  srn                 String?
  address             String?
  city                String?
  state               String?
  payment_terms       String?
  credit_limit        Decimal?    @default(0) @db.Decimal(12, 2)
  outstanding_balance Decimal?    @default(0) @db.Decimal(12, 2)
  created_at          DateTime?   @default(now()) @db.Timestamptz(6)
  updated_at          DateTime?   @default(now()) @db.Timestamptz(6)
  domain_data         Json?       @default("{}")
  opening_balance     Decimal?    @default(0) @db.Decimal(12, 2)
  filer_status        String?     @default("none") @db.VarChar(50)
  payments            payments[]
  purchases           purchases[]
  businesses          businesses  @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([domain_data], map: "idx_vendors_domain_data", type: Gin)
}

model product_batches {
  id                 String               @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id        String               @db.Uuid
  product_id         String               @db.Uuid
  warehouse_id       String?              @db.Uuid
  batch_number       String
  manufacturing_date DateTime?            @db.Date
  expiry_date        DateTime?            @db.Date
  quantity           Decimal?             @default(0) @db.Decimal(12, 2)
  reserved_quantity  Decimal?             @default(0) @db.Decimal(12, 2)
  cost_price         Decimal?             @default(0) @db.Decimal(12, 2)
  mrp                Decimal?             @default(0) @db.Decimal(12, 2)
  notes              String?
  is_active          Boolean?             @default(true)
  created_at         DateTime?            @default(now()) @db.Timestamptz(6)
  updated_at         DateTime?            @default(now()) @db.Timestamptz(6)
  domain_data        Json?                @default("{}")
  challan_items      challan_items[]
  businesses         businesses           @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products           products             @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  warehouses         warehouse_locations? @relation(fields: [warehouse_id], references: [id], onUpdate: NoAction)
  product_serials    product_serials[]
  stock_movements    stock_movements[]
  stock_transfers    stock_transfers[]

  @@unique([business_id, product_id, batch_number])
  @@index([domain_data], map: "idx_product_batches_domain_data_gin", type: Gin)
  @@index([expiry_date], map: "idx_product_batches_expiry_date")
  @@index([product_id], map: "idx_product_batches_product_id")
}

model warehouse_locations {
  id                      String                    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id             String                    @db.Uuid
  name                    String
  address                 String?
  city                    String?
  type                    String?                   @default("warehouse")
  is_active               Boolean?                  @default(true)
  created_at              DateTime?                 @default(now()) @db.Timestamptz(6)
  updated_at              DateTime?                 @default(now()) @db.Timestamptz(6)
  code                    String?                   @db.VarChar(50)
  contact_person          String?                   @db.VarChar(100)
  phone                   String?                   @db.VarChar(50)
  email                   String?                   @db.VarChar(100)
  is_primary              Boolean?                  @default(false)
  product_batches         product_batches[]
  product_serials         product_serials[]
  product_stock_locations product_stock_locations[]
  production_orders       production_orders[]
  stock_movements         stock_movements[]
  stock_transfers_from    stock_transfers[]         @relation("stock_transfers_from_location")
  stock_transfers_to      stock_transfers[]         @relation("stock_transfers_to_location")
  businesses              businesses                @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model purchase_items {
  id           String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  purchase_id  String    @db.Uuid
  product_id   String?   @db.Uuid
  description  String?
  quantity     Decimal?  @default(1) @db.Decimal(12, 2)
  unit_cost    Decimal?  @default(0) @db.Decimal(12, 2)
  tax_rate     Decimal?  @default(0) @db.Decimal(5, 2)
  total_amount Decimal?  @default(0) @db.Decimal(12, 2)
  batch_id     String?   @db.Uuid
  created_at   DateTime? @default(now()) @db.Timestamptz(6)
  products     products? @relation(fields: [product_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  purchases    purchases @relation(fields: [purchase_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([product_id], map: "idx_purchase_items_product_id")
  @@index([purchase_id], map: "idx_purchase_items_purchase_id")
}

model invoice_items {
  id              String     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id     String     @db.Uuid
  invoice_id      String     @db.Uuid
  product_id      String?    @db.Uuid
  name            String?
  description     String?
  quantity        Decimal?   @default(1) @db.Decimal(12, 2)
  unit_price      Decimal?   @default(0) @db.Decimal(12, 2)
  tax_percent     Decimal?   @default(0) @db.Decimal(5, 2)
  tax_amount      Decimal?   @default(0) @db.Decimal(12, 2)
  discount_amount Decimal?   @default(0) @db.Decimal(12, 2)
  total_amount    Decimal?   @default(0) @db.Decimal(12, 2)
  metadata        Json?      @default("{}")
  created_at      DateTime?  @default(now()) @db.Timestamptz(6)
  businesses      businesses @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  invoices        invoices   @relation(fields: [invoice_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products        products?  @relation(fields: [product_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([business_id], map: "idx_invoice_items_business_id")
  @@index([invoice_id], map: "idx_invoice_items_invoice_id")
  @@index([product_id], map: "idx_invoice_items_product_id")
}

model stock_transfers {
  id                                                       String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  business_id                                              String              @db.Uuid
  transfer_number                                          String
  product_id                                               String              @db.Uuid
  batch_id                                                 String?             @db.Uuid
  from_warehouse_id                                        String              @db.Uuid
  to_warehouse_id                                          String              @db.Uuid
  quantity                                                 Decimal             @db.Decimal(12, 2)
  status                                                   String?             @default("pending")
  transfer_date                                            DateTime?           @db.Date
  actual_arrival_date                                      DateTime?           @db.Date
  notes                                                    String?
  created_at                                               DateTime?           @default(now()) @db.Timestamptz(6)
  updated_at                                               DateTime?           @default(now()) @db.Timestamptz(6)
  product_batches                                          product_batches?    @relation(fields: [batch_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  businesses                                               businesses          @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  warehouses_stock_transfers_from_warehouse_idTowarehouses warehouse_locations @relation("stock_transfers_from_location", fields: [from_warehouse_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "stock_transfers_from_warehouse_location_fkey")
  products                                                 products            @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  warehouses_stock_transfers_to_warehouse_idTowarehouses   warehouse_locations @relation("stock_transfers_to_location", fields: [to_warehouse_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "stock_transfers_to_warehouse_location_fkey")

  @@index([business_id], map: "idx_stock_transfers_business")
  @@index([product_id], map: "idx_stock_transfers_product")
}

model inventory_ledger {
  id               String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  business_id      String     @db.Uuid
  warehouse_id     String?    @db.Uuid
  product_id       String?    @db.Uuid
  transaction_type String
  reference_id     String?    @db.Uuid
  reference_type   String?
  quantity_change  Decimal    @db.Decimal(12, 2)
  running_balance  Decimal?   @db.Decimal(12, 2)
  unit_cost        Decimal?   @db.Decimal(12, 2)
  total_value      Decimal?   @db.Decimal(12, 2)
  batch_number     String?
  serial_number    String?
  notes            String?
  created_at       DateTime?  @default(now()) @db.Timestamptz(6)
  businesses       businesses @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products         products?  @relation(fields: [product_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([business_id], map: "idx_inventory_ledger_business")
  @@index([product_id], map: "idx_inventory_ledger_product")
}

model quotations {
  id                 String            @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id        String            @db.Uuid
  customer_id        String?           @db.Uuid
  quotation_number   String
  date               DateTime?         @default(dbgenerated("CURRENT_DATE")) @db.Date
  valid_until        DateTime?         @db.Date
  status             String?           @default("draft")
  subtotal           Decimal?          @default(0) @db.Decimal(12, 2)
  tax_total          Decimal?          @default(0) @db.Decimal(12, 2)
  grand_total        Decimal?          @default(0) @db.Decimal(12, 2)
  notes              String?
  terms              String?
  domain_data        Json?             @default("{}")
  created_at         DateTime?         @default(now()) @db.Timestamptz(6)
  updated_at         DateTime?         @default(now()) @db.Timestamptz(6)
  total_amount       Decimal?          @default(0) @db.Decimal(12, 2)
  converted_to_order Boolean?          @default(false)
  quotation_items    quotation_items[]
  businesses         businesses        @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  customers          customers?        @relation(fields: [customer_id], references: [id], onUpdate: NoAction)
  sales_orders       sales_orders[]

  @@unique([business_id, quotation_number], map: "unique_quotation_number")
  @@index([business_id], map: "idx_quotations_business_id")
  @@index([customer_id], map: "idx_quotations_customer_id")
  @@index([status], map: "idx_quotations_status")
  @@index([date], map: "idx_quotations_date")
  @@index([domain_data], map: "idx_quotations_domain_data", type: Gin)
}

model sales_orders {
  id                String              @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id       String              @db.Uuid
  quotation_id      String?             @db.Uuid
  customer_id       String?             @db.Uuid
  order_number      String
  date              DateTime?           @default(dbgenerated("CURRENT_DATE")) @db.Date
  delivery_date     DateTime?           @db.Date
  status            String?             @default("pending")
  payment_status    String?             @default("pending")
  subtotal          Decimal?            @default(0) @db.Decimal(12, 2)
  tax_total         Decimal?            @default(0) @db.Decimal(12, 2)
  grand_total       Decimal?            @default(0) @db.Decimal(12, 2)
  notes             String?
  shipping_address  String?
  domain_data       Json?               @default("{}")
  created_at        DateTime?           @default(now()) @db.Timestamptz(6)
  updated_at        DateTime?           @default(now()) @db.Timestamptz(6)
  total_amount      Decimal?            @default(0) @db.Decimal(12, 2)
  delivery_challans delivery_challans[]
  sales_order_items sales_order_items[]
  businesses        businesses          @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  customers         customers?          @relation(fields: [customer_id], references: [id], onUpdate: NoAction)
  quotations        quotations?         @relation(fields: [quotation_id], references: [id], onUpdate: NoAction)

  @@unique([business_id, order_number], map: "unique_order_number")
  @@index([business_id], map: "idx_sales_orders_business_id")
  @@index([customer_id], map: "idx_sales_orders_customer_id")
  @@index([status], map: "idx_sales_orders_status")
  @@index([delivery_date], map: "idx_sales_orders_delivery_date")
  @@index([domain_data], map: "idx_sales_orders_domain_data", type: Gin)
}

model sales_order_items {
  id             String       @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  sales_order_id String       @db.Uuid
  product_id     String?      @db.Uuid
  description    String?
  quantity       Decimal      @default(1) @db.Decimal(12, 2)
  unit_price     Decimal      @default(0) @db.Decimal(12, 2)
  tax_amount     Decimal?     @default(0) @db.Decimal(12, 2)
  total_amount   Decimal?     @default(0) @db.Decimal(12, 2)
  business_id    String?      @db.Uuid
  batch_number   String?
  serial_number  String?
  expiry_date    DateTime?    @db.Date
  businesses     businesses?  @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products       products?    @relation(fields: [product_id], references: [id], onDelete: Restrict, onUpdate: NoAction)
  sales_orders   sales_orders @relation(fields: [sales_order_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([sales_order_id], map: "idx_sales_order_items_order_id")
  @@index([product_id], map: "idx_sales_order_items_product_id")
  @@index([batch_number], map: "idx_so_items_batch")
  @@index([serial_number], map: "idx_so_items_serial")
}

model delivery_challans {
  id                     String                   @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id            String                   @db.Uuid
  sales_order_id         String?                  @db.Uuid
  customer_id            String?                  @db.Uuid
  challan_number         String
  date                   DateTime?                @default(dbgenerated("CURRENT_DATE")) @db.Date
  status                 String?                  @default("issued")
  driver_name            String?
  vehicle_number         String?
  notes                  String?
  domain_data            Json?                    @default("{}")
  created_at             DateTime?                @default(now()) @db.Timestamptz(6)
  updated_at             DateTime?                @default(now()) @db.Timestamptz(6)
  delivery_address       String?
  challan_items          challan_items[]
  delivery_challan_items delivery_challan_items[]
  businesses             businesses               @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  customers              customers?               @relation(fields: [customer_id], references: [id], onUpdate: NoAction)
  sales_orders           sales_orders?            @relation(fields: [sales_order_id], references: [id], onUpdate: NoAction)

  @@unique([business_id, challan_number], map: "unique_challan_number")
  @@index([business_id], map: "idx_delivery_challans_business_id")
  @@index([customer_id], map: "idx_delivery_challans_customer_id")
  @@index([status], map: "idx_delivery_challans_status")
  @@index([domain_data], map: "idx_delivery_challans_domain_data", type: Gin)
}

model challan_items {
  id                String            @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  challan_id        String            @db.Uuid
  product_id        String?           @db.Uuid
  batch_id          String?           @db.Uuid
  name              String?           @db.VarChar(255)
  quantity          Decimal?          @default(1) @db.Decimal(12, 2)
  serial_numbers    String[]
  created_at        DateTime?         @default(now()) @db.Timestamptz(6)
  product_batches   product_batches?  @relation(fields: [batch_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  delivery_challans delivery_challans @relation(fields: [challan_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products          products?         @relation(fields: [product_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([challan_id], map: "idx_challan_items_challan_id")
  @@index([product_id], map: "idx_challan_items_product_id")
}

model payments {
  id             String     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id    String     @db.Uuid
  payment_type   String     @db.VarChar(50)
  reference_type String?    @db.VarChar(50)
  reference_id   String?    @db.Uuid
  customer_id    String?    @db.Uuid
  vendor_id      String?    @db.Uuid
  amount         Decimal    @db.Decimal(12, 2)
  payment_mode   String?    @db.VarChar(50)
  payment_date   DateTime   @db.Date
  bank_name      String?    @db.VarChar(255)
  cheque_number  String?    @db.VarChar(100)
  transaction_id String?    @db.VarChar(255)
  notes          String?
  domain_data    Json?      @default("{}")
  created_at     DateTime?  @default(now()) @db.Timestamptz(6)
  updated_at     DateTime?  @default(now()) @db.Timestamptz(6)
  businesses     businesses @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  customers      customers? @relation(fields: [customer_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  vendors        vendors?   @relation(fields: [vendor_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([business_id], map: "idx_payments_business_id")
  @@index([customer_id], map: "idx_payments_customer_id")
  @@index([payment_date], map: "idx_payments_date")
  @@index([reference_type, reference_id], map: "idx_payments_reference")
  @@index([vendor_id], map: "idx_payments_vendor_id")
  @@index([domain_data], map: "idx_payments_domain_data", type: Gin)
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model delivery_challan_items {
  id                  String            @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  delivery_challan_id String            @db.Uuid
  product_id          String?           @db.Uuid
  description         String?
  quantity            Decimal           @default(1) @db.Decimal(12, 2)
  business_id         String?           @db.Uuid
  batch_number        String?
  serial_number       String?
  businesses          businesses?       @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  delivery_challans   delivery_challans @relation(fields: [delivery_challan_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products            products?         @relation(fields: [product_id], references: [id], onDelete: Restrict, onUpdate: NoAction)

  @@index([delivery_challan_id], map: "idx_delivery_challan_items_challan_id")
  @@index([product_id], map: "idx_delivery_challan_items_product_id")
}

model product_stock_locations {
  id                  String               @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id         String               @db.Uuid
  product_id          String               @db.Uuid
  warehouse_id        String               @db.Uuid
  quantity            Decimal?             @default(0) @db.Decimal(12, 2)
  state               String?              @default("sellable") @db.VarChar(50)
  updated_at          DateTime?            @default(now()) @db.Timestamptz(6)
  businesses          businesses           @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products            products             @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  warehouse_locations warehouse_locations? @relation(fields: [warehouse_id], references: [id], onUpdate: NoAction)

  @@unique([product_id, warehouse_id, state])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model quotation_items {
  id            String      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  quotation_id  String      @db.Uuid
  product_id    String?     @db.Uuid
  description   String?
  quantity      Decimal     @default(1) @db.Decimal(12, 2)
  unit_price    Decimal     @default(0) @db.Decimal(12, 2)
  tax_amount    Decimal?    @default(0) @db.Decimal(12, 2)
  total_amount  Decimal?    @default(0) @db.Decimal(12, 2)
  business_id   String?     @db.Uuid
  batch_number  String?
  serial_number String?
  businesses    businesses? @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products      products?   @relation(fields: [product_id], references: [id], onDelete: Restrict, onUpdate: NoAction)
  quotations    quotations  @relation(fields: [quotation_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([product_id], map: "idx_quotation_items_product_id")
  @@index([quotation_id], map: "idx_quotation_items_quotation_id")
}

model workflow_rules {
  id               String             @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id      String             @db.Uuid
  name             String
  rule_text        String
  rule_logic       Json?              @default("{}")
  is_active        Boolean            @default(true)
  created_at       DateTime           @default(now()) @db.Timestamptz(6)
  updated_at       DateTime           @default(now()) @db.Timestamptz(6)
  businesses       businesses         @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  workflow_history workflow_history[]

  @@index([business_id], map: "idx_workflow_rules_business_id")
}

model workflow_history {
  id             String          @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_id    String          @db.Uuid
  rule_id        String?         @db.Uuid
  event_type     String
  description    String
  context        Json?           @default("{}")
  result         Json?           @default("{}")
  created_at     DateTime        @default(now()) @db.Timestamptz(6)
  businesses     businesses      @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  workflow_rules workflow_rules? @relation(fields: [rule_id], references: [id], onDelete: SetNull, onUpdate: NoAction)

  @@index([business_id], map: "idx_workflow_history_business_id")
  @@index([rule_id], map: "idx_workflow_history_rule_id")
}

model audit_logs {
  id          String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  business_id String     @db.Uuid
  user_id     String?
  user_email  String?
  user_name   String?
  action      String
  entity_type String
  entity_id   String?
  description String?
  changes     Json?      @default("{}")
  metadata    Json?      @default("{}")
  ip_address  String?
  user_agent  String?
  created_at  DateTime?  @default(now()) @db.Timestamptz(6)
  businesses  businesses @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([business_id])
  @@index([entity_type, entity_id])
  @@index([created_at(sort: Desc)])
}

model promotions {
  id                 String               @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  business_id        String               @db.Uuid
  name               String
  description        String?
  type               String               @default("discount") // discount, buy_x_get_y, bundle, shipping
  value              Decimal              @db.Decimal(12, 2)
  is_percentage      Boolean              @default(true)
  starts_at          DateTime?            @db.Timestamptz(6)
  ends_at            DateTime?            @db.Timestamptz(6)
  min_order_amount   Decimal?             @default(0) @db.Decimal(12, 2)
  max_discount       Decimal?             @db.Decimal(12, 2)
  usage_limit        Int?
  usage_count        Int                  @default(0)
  is_active          Boolean              @default(true)
  is_ai_generated    Boolean              @default(false)
  created_at         DateTime             @default(now()) @db.Timestamptz(6)
  updated_at         DateTime             @default(now()) @db.Timestamptz(6)
  businesses         businesses           @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  promotion_products promotion_products[]

  @@index([business_id])
  @@index([is_active, starts_at, ends_at])
}

model promotion_products {
  id           String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  promotion_id String     @db.Uuid
  product_id   String     @db.Uuid
  promotions   promotions @relation(fields: [promotion_id], references: [id], onDelete: Cascade)
  products     products   @relation(fields: [product_id], references: [id], onDelete: Cascade)

  @@unique([promotion_id, product_id])
}

model campaigns {
  id                String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  business_id       String              @db.Uuid
  name              String
  description       String?
  type              String              @default("email") // email, whatsapp, notification
  status            String              @default("draft") // draft, scheduled, active, completed, cancelled
  segment_id        String?             @db.Uuid
  template_id       String?
  scheduled_at      DateTime?           @db.Timestamptz(6)
  sent_at           DateTime?           @db.Timestamptz(6)
  is_automated      Boolean             @default(false)
  metadata          Json?               @default("{}")
  created_at        DateTime            @default(now()) @db.Timestamptz(6)
  updated_at        DateTime            @default(now()) @db.Timestamptz(6)
  businesses        businesses          @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  customer_segments customer_segments?  @relation(fields: [segment_id], references: [id])
  messages          campaign_messages[]

  @@index([business_id])
}

model campaign_messages {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  campaign_id  String    @db.Uuid
  customer_id  String    @db.Uuid
  status       String    @default("pending") // pending, sent, delivered, opened, failed
  external_id  String?
  error        String?
  sent_at      DateTime? @db.Timestamptz(6)
  delivered_at DateTime? @db.Timestamptz(6)
  opened_at    DateTime? @db.Timestamptz(6)
  campaigns    campaigns @relation(fields: [campaign_id], references: [id], onDelete: Cascade)

  @@index([campaign_id])
  @@index([customer_id])
}

model customer_segments {
  id                String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  business_id       String              @db.Uuid
  name              String
  description       String?
  rules             Json                @default("{}")
  is_dynamic        Boolean             @default(true)
  created_at        DateTime            @default(now()) @db.Timestamptz(6)
  updated_at        DateTime            @default(now()) @db.Timestamptz(6)
  businesses        businesses          @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  campaigns         campaigns[]
  segment_customers segment_customers[]

  @@index([business_id])
}

model segment_customers {
  id          String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  segment_id  String            @db.Uuid
  customer_id String            @db.Uuid
  created_at  DateTime          @default(now()) @db.Timestamptz(6)
  segments    customer_segments @relation(fields: [segment_id], references: [id], onDelete: Cascade)

  @@unique([segment_id, customer_id])
}

model inventory_reservations {
  id          String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  business_id String     @db.Uuid
  product_id  String     @db.Uuid
  batch_id    String?    @db.Uuid
  quantity    Decimal    @db.Decimal(12, 2)
  expires_at  DateTime   @db.Timestamptz(6)
  status      String     @default("active") // active, completed, cancelled, expired
  reference   String? // e.g. "order_123"
  created_at  DateTime   @default(now()) @db.Timestamptz(6)
  updated_at  DateTime   @default(now()) @db.Timestamptz(6)
  businesses  businesses @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products    products   @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([business_id])
  @@index([product_id])
  @@index([expires_at])
}

model supplier_quotes {
  id           String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  business_id  String     @db.Uuid
  vendor_id    String     @db.Uuid
  product_id   String?    @db.Uuid
  quote_number String?
  price        Decimal    @db.Decimal(12, 2)
  valid_until  DateTime?  @db.Timestamptz(6)
  notes        String?
  is_selected  Boolean    @default(false)
  created_at   DateTime   @default(now()) @db.Timestamptz(6)
  updated_at   DateTime   @default(now()) @db.Timestamptz(6)
  businesses   businesses @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([business_id])
  @@index([vendor_id])
}

model price_lists {
  id          String             @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  business_id String             @db.Uuid
  name        String
  description String?
  currency    String             @default("PKR")
  is_active   Boolean            @default(true)
  created_at  DateTime           @default(now()) @db.Timestamptz(6)
  updated_at  DateTime           @default(now()) @db.Timestamptz(6)
  businesses  businesses         @relation(fields: [business_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  items       price_list_items[]

  @@index([business_id])
}

model price_list_items {
  id            String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  price_list_id String      @db.Uuid
  product_id    String      @db.Uuid
  price         Decimal     @db.Decimal(12, 2)
  min_quantity  Decimal     @default(1) @db.Decimal(12, 2)
  price_lists   price_lists @relation(fields: [price_list_id], references: [id], onDelete: Cascade)
  products      products    @relation(fields: [product_id], references: [id], onDelete: Cascade)

  @@unique([price_list_id, product_id])
}
